"use strict";(self.webpackChunkpro_react_admin=self.webpackChunkpro_react_admin||[]).push([[120],{90120:function(at,C,m){m.d(C,{diagram:function(){return et}});var b=m(22902),S=m(61491),R=m(29451),T=m(45625),t=m(15581),nt=m(27484),it=m(17967),st=m(27856);const N={},W=(e,n)=>{N[e]=n},U=e=>N[e],O=()=>Object.keys(N),v={get:U,set:W,keys:O,size:()=>O().length},D=e=>e.append("circle").attr("class","start-state").attr("r",(0,t.c)().state.sizeUnit).attr("cx",(0,t.c)().state.padding+(0,t.c)().state.sizeUnit).attr("cy",(0,t.c)().state.padding+(0,t.c)().state.sizeUnit),I=e=>e.append("line").style("stroke","grey").style("stroke-dasharray","3").attr("x1",(0,t.c)().state.textHeight).attr("class","divider").attr("x2",(0,t.c)().state.textHeight*2).attr("y1",0).attr("y2",0),G=(e,n)=>{const d=e.append("text").attr("x",2*(0,t.c)().state.padding).attr("y",(0,t.c)().state.textHeight+2*(0,t.c)().state.padding).attr("font-size",(0,t.c)().state.fontSize).attr("class","state-title").text(n.id),o=d.node().getBBox();return e.insert("rect",":first-child").attr("x",(0,t.c)().state.padding).attr("y",(0,t.c)().state.padding).attr("width",o.width+2*(0,t.c)().state.padding).attr("height",o.height+2*(0,t.c)().state.padding).attr("rx",(0,t.c)().state.radius),d},K=(e,n)=>{const d=function(c,B,f){const _=c.append("tspan").attr("x",2*(0,t.c)().state.padding).text(B);f||_.attr("dy",(0,t.c)().state.textHeight)},s=e.append("text").attr("x",2*(0,t.c)().state.padding).attr("y",(0,t.c)().state.textHeight+1.3*(0,t.c)().state.padding).attr("font-size",(0,t.c)().state.fontSize).attr("class","state-title").text(n.descriptions[0]).node().getBBox(),g=s.height,p=e.append("text").attr("x",(0,t.c)().state.padding).attr("y",g+(0,t.c)().state.padding*.4+(0,t.c)().state.dividerMargin+(0,t.c)().state.textHeight).attr("class","state-description");let a=!0,r=!0;n.descriptions.forEach(function(c){a||(d(p,c,r),r=!1),a=!1});const w=e.append("line").attr("x1",(0,t.c)().state.padding).attr("y1",(0,t.c)().state.padding+g+(0,t.c)().state.dividerMargin/2).attr("y2",(0,t.c)().state.padding+g+(0,t.c)().state.dividerMargin/2).attr("class","descr-divider"),x=p.node().getBBox(),l=Math.max(x.width,s.width);return w.attr("x2",l+3*(0,t.c)().state.padding),e.insert("rect",":first-child").attr("x",(0,t.c)().state.padding).attr("y",(0,t.c)().state.padding).attr("width",l+2*(0,t.c)().state.padding).attr("height",x.height+g+2*(0,t.c)().state.padding).attr("rx",(0,t.c)().state.radius),e},F=(e,n,d)=>{const o=(0,t.c)().state.padding,s=2*(0,t.c)().state.padding,g=e.node().getBBox(),p=g.width,a=g.x,r=e.append("text").attr("x",0).attr("y",(0,t.c)().state.titleShift).attr("font-size",(0,t.c)().state.fontSize).attr("class","state-title").text(n.id),x=r.node().getBBox().width+s;let l=Math.max(x,p);l===p&&(l=l+s);let c;const B=e.node().getBBox();n.doc,c=a-o,x>p&&(c=(p-l)/2+o),Math.abs(a-B.x)<o&&x>p&&(c=a-(x-p)/2);const f=1-(0,t.c)().state.textHeight;return e.insert("rect",":first-child").attr("x",c).attr("y",f).attr("class",d?"alt-composit":"composit").attr("width",l).attr("height",B.height+(0,t.c)().state.textHeight+(0,t.c)().state.titleShift+1).attr("rx","0"),r.attr("x",c+o),x<=p&&r.attr("x",a+(l-s)/2-x/2+o),e.insert("rect",":first-child").attr("x",c).attr("y",(0,t.c)().state.titleShift-(0,t.c)().state.textHeight-(0,t.c)().state.padding).attr("width",l).attr("height",(0,t.c)().state.textHeight*3).attr("rx",(0,t.c)().state.radius),e.insert("rect",":first-child").attr("x",c).attr("y",(0,t.c)().state.titleShift-(0,t.c)().state.textHeight-(0,t.c)().state.padding).attr("width",l).attr("height",B.height+3+2*(0,t.c)().state.textHeight).attr("rx",(0,t.c)().state.radius),e},Y=e=>(e.append("circle").attr("class","end-state-outer").attr("r",(0,t.c)().state.sizeUnit+(0,t.c)().state.miniPadding).attr("cx",(0,t.c)().state.padding+(0,t.c)().state.sizeUnit+(0,t.c)().state.miniPadding).attr("cy",(0,t.c)().state.padding+(0,t.c)().state.sizeUnit+(0,t.c)().state.miniPadding),e.append("circle").attr("class","end-state-inner").attr("r",(0,t.c)().state.sizeUnit).attr("cx",(0,t.c)().state.padding+(0,t.c)().state.sizeUnit+2).attr("cy",(0,t.c)().state.padding+(0,t.c)().state.sizeUnit+2)),j=(e,n)=>{let d=(0,t.c)().state.forkWidth,o=(0,t.c)().state.forkHeight;if(n.parentId){let s=d;d=o,o=s}return e.append("rect").style("stroke","black").style("fill","black").attr("width",d).attr("height",o).attr("x",(0,t.c)().state.padding).attr("y",(0,t.c)().state.padding)},X=(e,n,d,o)=>{let s=0;const g=o.append("text");g.style("text-anchor","start"),g.attr("class","noteText");let p=e.replace(/\r\n/g,"<br/>");p=p.replace(/\n/g,"<br/>");const a=p.split(t.e.lineBreakRegex);let r=1.25*(0,t.c)().state.noteMargin;for(const w of a){const x=w.trim();if(x.length>0){const l=g.append("tspan");if(l.text(x),r===0){const c=l.node().getBBox();r+=c.height}s+=r,l.attr("x",n+(0,t.c)().state.noteMargin),l.attr("y",d+s+1.25*(0,t.c)().state.noteMargin)}}return{textWidth:g.node().getBBox().width,textHeight:s}},$=(e,n)=>{n.attr("class","state-note");const d=n.append("rect").attr("x",0).attr("y",(0,t.c)().state.padding),o=n.append("g"),{textWidth:s,textHeight:g}=X(e,0,0,o);return d.attr("height",g+2*(0,t.c)().state.noteMargin),d.attr("width",s+(0,t.c)().state.noteMargin*2),d},H=function(e,n){const d=n.id,o={id:d,label:n.id,width:0,height:0},s=e.append("g").attr("id",d).attr("class","stateGroup");n.type==="start"&&D(s),n.type==="end"&&Y(s),(n.type==="fork"||n.type==="join")&&j(s,n),n.type==="note"&&$(n.note.text,s),n.type==="divider"&&I(s),n.type==="default"&&n.descriptions.length===0&&G(s,n),n.type==="default"&&n.descriptions.length>0&&K(s,n);const g=s.node().getBBox();return o.width=g.width+2*(0,t.c)().state.padding,o.height=g.height+2*(0,t.c)().state.padding,v.set(d,o),o};let z=0;const J=function(e,n,d){const o=function(r){switch(r){case b.d.relationType.AGGREGATION:return"aggregation";case b.d.relationType.EXTENSION:return"extension";case b.d.relationType.COMPOSITION:return"composition";case b.d.relationType.DEPENDENCY:return"dependency"}};n.points=n.points.filter(r=>!Number.isNaN(r.y));const s=n.points,g=(0,S.jvg)().x(function(r){return r.x}).y(function(r){return r.y}).curve(S.$0Z),p=e.append("path").attr("d",g(s)).attr("id","edge"+z).attr("class","transition");let a="";if((0,t.c)().state.arrowMarkerAbsolute&&(a=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,a=a.replace(/\(/g,"\\("),a=a.replace(/\)/g,"\\)")),p.attr("marker-end","url("+a+"#"+o(b.d.relationType.DEPENDENCY)+"End)"),d.title!==void 0){const r=e.append("g").attr("class","stateLabel"),{x:w,y:x}=t.u.calcLabelPosition(n.points),l=t.e.getRows(d.title);let c=0;const B=[];let f=0,_=0;for(let u=0;u<=l.length;u++){const h=r.append("text").attr("text-anchor","middle").text(l[u]).attr("x",w).attr("y",x+c),y=h.node().getBBox();f=Math.max(f,y.width),_=Math.min(_,y.x),t.l.info(y.x,w,x+c),c===0&&(c=h.node().getBBox().height,t.l.info("Title height",c,x)),B.push(h)}let k=c*l.length;if(l.length>1){const u=(l.length-1)*c*.5;B.forEach((h,y)=>h.attr("y",x+y*c-u)),k=c*l.length}const i=r.node().getBBox();r.insert("rect",":first-child").attr("class","box").attr("x",w-f/2-(0,t.c)().state.padding/2).attr("y",x-k/2-(0,t.c)().state.padding/2-3.5).attr("width",f+(0,t.c)().state.padding).attr("height",k+(0,t.c)().state.padding),t.l.info(i)}z++};let E;const L={},Z=function(){},Q=function(e){e.append("defs").append("marker").attr("id","dependencyEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},V=function(e,n,d,o){E=(0,t.c)().state;const s=(0,t.c)().securityLevel;let g;s==="sandbox"&&(g=(0,S.Ys)("#i"+n));const p=s==="sandbox"?(0,S.Ys)(g.nodes()[0].contentDocument.body):(0,S.Ys)("body"),a=s==="sandbox"?g.nodes()[0].contentDocument:document;t.l.debug("Rendering diagram "+e);const r=p.select(`[id='${n}']`);Q(r),new T.k({multigraph:!0,compound:!0,rankdir:"RL"}).setDefaultEdgeLabel(function(){return{}});const x=o.db.getRootDoc();A(x,r,void 0,!1,p,a,o);const l=E.padding,c=r.node().getBBox(),B=c.width+l*2,f=c.height+l*2,_=B*1.75;(0,t.i)(r,f,_,E.useMaxWidth),r.attr("viewBox",`${c.x-E.padding}  ${c.y-E.padding} `+B+" "+f)},q=e=>e?e.length*E.fontSizeFactor:1,A=(e,n,d,o,s,g,p)=>{const a=new T.k({compound:!0,multigraph:!0});let r,w=!0;for(r=0;r<e.length;r++)if(e[r].stmt==="relation"){w=!1;break}d?a.setGraph({rankdir:"LR",multigraph:!0,compound:!0,ranker:"tight-tree",ranksep:w?1:E.edgeLengthFactor,nodeSep:w?1:50,isMultiGraph:!0}):a.setGraph({rankdir:"TB",multigraph:!0,compound:!0,ranksep:w?1:E.edgeLengthFactor,nodeSep:w?1:50,ranker:"tight-tree",isMultiGraph:!0}),a.setDefaultEdgeLabel(function(){return{}}),p.db.extract(e);const x=p.db.getStates(),l=p.db.getRelations(),c=Object.keys(x);for(const i of c){const u=x[i];d&&(u.parentId=d);let h;if(u.doc){let y=n.append("g").attr("id",u.id).attr("class","stateGroup");h=A(u.doc,y,u.id,!o,s,g,p);{y=F(y,u,o);let M=y.node().getBBox();h.width=M.width,h.height=M.height+E.padding/2,L[u.id]={y:E.compositTitleSize}}}else h=H(n,u);if(u.note){const y={descriptions:[],id:u.id+"-note",note:u.note,type:"note"},M=H(n,y);u.note.position==="left of"?(a.setNode(h.id+"-note",M),a.setNode(h.id,h)):(a.setNode(h.id,h),a.setNode(h.id+"-note",M)),a.setParent(h.id,h.id+"-group"),a.setParent(h.id+"-note",h.id+"-group")}else a.setNode(h.id,h)}t.l.debug("Count=",a.nodeCount(),a);let B=0;l.forEach(function(i){B++,t.l.debug("Setting edge",i),a.setEdge(i.id1,i.id2,{relation:i,width:q(i.title),height:E.labelHeight*t.e.getRows(i.title).length,labelpos:"c"},"id"+B)}),(0,R.bK)(a),t.l.debug("Graph after layout",a.nodes());const f=n.node();a.nodes().forEach(function(i){i!==void 0&&a.node(i)!==void 0?(t.l.warn("Node "+i+": "+JSON.stringify(a.node(i))),s.select("#"+f.id+" #"+i).attr("transform","translate("+(a.node(i).x-a.node(i).width/2)+","+(a.node(i).y+(L[i]?L[i].y:0)-a.node(i).height/2)+" )"),s.select("#"+f.id+" #"+i).attr("data-x-shift",a.node(i).x-a.node(i).width/2),g.querySelectorAll("#"+f.id+" #"+i+" .divider").forEach(h=>{const y=h.parentElement;let M=0,P=0;y&&(y.parentElement&&(M=y.parentElement.getBBox().width),P=parseInt(y.getAttribute("data-x-shift"),10),Number.isNaN(P)&&(P=0)),h.setAttribute("x1",0-P+8),h.setAttribute("x2",M-P-8)})):t.l.debug("No Node "+i+": "+JSON.stringify(a.node(i)))});let _=f.getBBox();a.edges().forEach(function(i){i!==void 0&&a.edge(i)!==void 0&&(t.l.debug("Edge "+i.v+" -> "+i.w+": "+JSON.stringify(a.edge(i))),J(n,a.edge(i),a.edge(i).relation))}),_=f.getBBox();const k={id:d||"root",label:d||"root",width:0,height:0};return k.width=_.width+2*E.padding,k.height=_.height+2*E.padding,t.l.debug("Doc rendered",k,a),k},tt={setConf:Z,draw:V},et={parser:b.p,db:b.d,renderer:tt,styles:b.s,init:e=>{e.state||(e.state={}),e.state.arrowMarkerAbsolute=e.arrowMarkerAbsolute,b.d.clear()}}}}]);

//# sourceMappingURL=120.71dcf02bdfbfb03d43a4.js.map